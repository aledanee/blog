<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog App</title>
</head>
<body>
    <h1>Login</h1>
    <form id="loginForm">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required><br>

        <label for="password">Password:</label>
        <input type="password" id="password" name="password" required><br>

        <button type="button" onclick="login()">Login</button>
    </form>

    <div id="result"></div>

    <h2>Posts</h2>
    <div id="postResult"></div>

    <!-- Button to return to the registration page -->
    <button onclick="goToRegistrationPage()">Register</button>

    <script>
    async function login() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        // Call the login API
        const loginResponse = await fetch('http://localhost:8000/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ username, password }),
        });

        const loginData = await loginResponse.json();

        if ('error' in loginData) {
            document.getElementById('result').innerText = `Error: ${loginData.error}`;
        } else {
            document.getElementById('result').innerText = `Success: ${loginData.message}`;

            // Call the display post API
            const postResponse = await fetch('http://localhost:8000/display_post');
            const postData = await postResponse.json();

            if ('error' in postData) {
                document.getElementById('postResult').innerText = `Error: ${postData.error}`;
            } else {
                const posts = postData.posts;
                const postList = posts.map(post => `<p>${post.title}: ${post.content}</p>`).join('');
                document.getElementById('postResult').innerHTML = postList;
            }

            // Redirect to the index page
            window.location.href = 'index.html';
        }
    }

    // Function to navigate to the registration page
    function goToRegistrationPage() {
        window.location.href = 'register.html';
    }
</script>

</body>
</html>
